library(twitteR)
library(tm)
library(SnowballC)
library(RWeka)
library(rJava)
library(RWekajars)
library(memoise)
library(wordcloud)
load(file = "D://rdmTweets.RData")
text <- readLines("D://urdu",encoding='UTF-8')
for (i in 11:15)
{
  cat(paste("[[", i, "]] ", sep=""))
  writeLines(strwrap(rdmTweets[[i]]$getText(), width=73))
}

# -------------------------------------------------------------------------------

df <- do.call("rbind", lapply(rdmTweets, as.data.frame))
df
dim(df)
text<-"?????? ?????????????????? ???????? ???? ?????????? ?????????????????? ?????????? ???? ?????? ?????????? ???????????? ???? ?????????? ???? ??????
?????? ?????? ?????????? ?????? ???????? ?????? ?????? ?????????? ?????? ?????? ?????? ???? ?????? ?????? ???????? ?????? ?????? ??????????
???????? ???? ?????????????? ???? ???? ???? ???? ???? ?????? ???? ?????????? ???? ???????? ?????? ?????? ????????. ???? ?????? ???? ?????? ????????
???? ?????? ???? ???? ???????? ?????? ?????? ?????? ???????? ???? ?????? ???????????? ???? ?????????? ???????????? ???????? ?????????? ???? ?????????? ???? ???? ????????
?????? ?????? ?????? ?????? ?????????? ???? ?????????????? ???? ???? ????????"
myCorpus <- Corpus(VectorSource(df$text))
myCorpus <- Corpus(VectorSource(text))
myCorpus
inspect(myCorpus)

myCorpus <- tm_map(myCorpus, content_transformer(tolower))

myCorpus <- tm_map(myCorpus, removePunctuation)

myCorpus <- tm_map(myCorpus, removeNumbers)

removeURL <- function(x) gsub("http[[:alnum:]]*", "", x)
myCorpus <- tm_map(myCorpus, removeURL)

myStopwords <- c(stopwords('english'), "available", "via")

myStopwords <- setdiff(myStopwords, c("r", "big"))

toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
myCorpus <- tm_map(myCorpus, removeWords, myStopwords)
myCorpus <- tm_map(myCorpus, removeWords, stopwords("english"))
myCorpus <- tm_map(myCorpus, removeWords, stopwords("urdu"))
myCorpus <- tm_map(myCorpus, stripWhitespace)
myCorpus <- tm_map(myCorpus, PlainTextDocument)
myCorpus <- tm_map(myCorpus, toSpace, "/")
myCorpus <- tm_map(myCorpus, toSpace, "@")
myCorpus <- tm_map(myCorpus, toSpace, "\\|")

# -------------------------------------------------------------------------------
myTdm <- TermDocumentMatrix(myCorpus, control = list(stemming = TRUE))
myTdm <- TermDocumentMatrix(myCorpus) 
m <- as.matrix(myTdm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)
cbind(stems = rownames(myTdm), completed = stemCompletion(rownames(myTdm), myCorpus))
set.seed(1234)
wordcloud(words = d$word, freq = d$freq, min.freq = 3,max.words=2000, random.order=FALSE,rot.per=0.35,colors=brewer.pal(8, "Dark2"))
m <- as.matrix(myTdm)

wordFreq <- sort(rowSums(m), decreasing=TRUE)


inspect(myCorpus)
myTdm <- TermDocumentMatrix(myCorpus, control=list(wordLengths=c(1,Inf)))
myTdm
rownames(myTdm)
inspect(myTdm)
idx <- which(dimnames(myTdm)$Terms == "r")
inspect(myTdm[idx+(0:5),10:110])
myTdm <- TermDocumentMatrix(myCorpus, control=list(minWordLength=1))
myTdm
# -------------------------------------------------------------------------------


findFreqTerms(myTdm, lowfreq=10)
termFrequency <- rowSums(as.matrix(myTdm))
termFrequency <- subset(termFrequency, termFrequency>=20)
library(ggplot2)
qplot(names(termFrequency), termFrequency, geom="bar", xlab="Terms") + coord_flip()
barplot(termFrequency, las=2)


findAssocs(myTdm, 'r', 0.25)

findAssocs(myTdm, 'mining', 0.25)


library(wordcloud)
m <- as.matrix(myTdm)

wordFreq <- sort(rowSums(m), decreasing=TRUE)

set.seed(375)
grayLevels <- gray( (wordFreq+10) / (max(wordFreq)+10) )
wordcloud(words=names(wordFreq), freq=wordFreq, min.freq=3, random.order=F, colors=grayLevels)


myTdm2 <- removeSparseTerms(myTdm, sparse=0.9)
m2 <- as.matrix(myTdm2)


distMatrix <- dist(scale(m2))
fit <- hclust(distMatrix, method="ward")
plot(fit)
rect.hclust(fit, k=10)
(groups <- cutree(fit, k=10))

m3 <- t(m2)
set.seed(122)
k <- 8
kmeansResult <- kmeans(m3, k)
round(kmeansResult$centers, digits=3)
for (i in 1:k)
{
cat(paste("cluster ", i, ": ", sep=""))
s <- sort(kmeansResult$centers[i,], decreasing=T)
cat(names(s)[1:3], "\n")
}

library(fpc)
pamResult <- pamk(m3, metric="manhattan")
(k <- pamResult$nc)
pamResult <- pamResult$pamobject
for (i in 1:k) {
cat(paste("cluster", i, ": "))
cat(colnames(pamResult$medoids)[which(pamResult$medoids[i,]==1)], "\n")
}
layout(matrix(c(1,2),2,1))
plot(pamResult, color=F, labels=4, lines=0, cex=.8, col.clus=1,
col.p=pamResult$clustering)
layout(matrix(1))
pamResult2 <- pamk(m3, krange=2:8, metric="manhattan")

# -------------------------------------------------------------------------------

